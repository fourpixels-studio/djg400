{% extends 'base.html' %}
{% load static %}
{% block body %}
{% load hitcount_tags %}
<div class="container p-4">
  
  <div class="row justify-content-evenly g-3 rounded-4">

    <div class="col-sm-12 col-lg-6 px-0 position-relative">
      <a href="{% url 'mix_list' %}" class="back-btn text-white position-absolute"><i class="fa-solid fa-xl fa-circle-arrow-left"></i></a>
      <img loading="lazy" src="{{ mix.get_square_cover }}" alt="" class="rounded-4 img-fluid w-100">
    </div>

    <div class="col-sm-12 col-lg-5">
      <div class="d-flex flex-row align-items-center">
        <!-- <div id="playButton" class="h1 hover me-3"><i id="playIcon" style="color: {{ mix.color }};" class="fa-solid"></i></div> -->
        <div>
          <h1 class="text-white">{{ mix.get_title }}</h1>
          <h4 class="grey-1">Vol {{ mix.episode_number }} - {{ mix.get_year }}</h4>
          {% if request.user.is_superuser %}
          <p class="grey-1">{% get_hit_count for mix %} views</p>
          {% endif %}
        </div>
      </div>
      <div class="d-flex flex-row">
        {% if mix.get_stream_link %}
        <audio src="{{ mix.stream_link }}" controls class="w-100">
          <source type="audio/mpeg" />
          Your browser does not support the audio element.
        </audio>
        {% else %}
        <div class="badge bg-primary text-dark">Link coming soon</div>
        {% endif %}
      </div>
      <p class="grey-2 my-4">{{ mix.album.description }}</p>
      <!-- <div class="flex-row d-flex mt-5">
        <i class="fa-solid hover fa-heart grey-1 me-2 fa-xl"></i>
        <i class="fa-solid hover fa-arrow-up-from-bracket grey-1 fa-xl"></i>
      </div> -->
    </div>

  </div>

  {% if mix.get_similar_mixes %}
  <h2 class="grey-2 mt-5">Explore similar mixes</h2>
  <div class="row my-5 g-3">
    {% for mix in mix.get_similar_mixes %}
    <div class="col-sm-12 col-lg-3">
      <div class="rounded-4 px-3 pt-3 bg-grey pb-2">
        <img src="{{ mix.get_square_thumbnail }}" class="img-similar-mixes mb-2">
        <a href="{{ mix.get_url }}" class="grey-1 no-btn hover-underline">{{ mix.get_title }}</a>
        <div class="d-flex flex-row justify-content-between align-items-center">
          <p class="grey-3 m-0">{{ mix.genre.name }}</p>
          <small class="grey-4 m-0">{{ mix.get_year }}</small>
        </div>
      </div>
    </div>
    {% endfor %}
  </div>
  {% endif %}
</div>
<script>
        const playButton = document.getElementById('playButton');
        const playIcon = document.getElementById('playIcon');
        playIcon.classList.add("fa-play")

        playButton.addEventListener('click', () => {
          if(playIcon.classList.contains("fa-play")){
            playIcon.classList.remove("fa-play")
            playIcon.classList.add("fa-pause")
          }
          else{
            playIcon.classList.remove("fa-pause")
            playIcon.classList.add("fa-play")
          }
        });

    </script>
{% endblock %}